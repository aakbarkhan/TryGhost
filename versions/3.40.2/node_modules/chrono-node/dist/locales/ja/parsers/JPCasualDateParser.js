"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
var dayjs_1 = __importDefault(require("dayjs"));
var index_1 = require("../../../index");
var PATTERN = /今日|当日|昨日|明日|今夜|今夕|今晩|今朝/i;
var JPCasualDateParser = (function () {
    function JPCasualDateParser() {
    }
    JPCasualDateParser.prototype.pattern = function () {
        return PATTERN;
    };
    JPCasualDateParser.prototype.extract = function (context, match) {
        var text = match[0];
        var date = dayjs_1.default(context.refDate);
        var components = context.createParsingComponents();
        if (text == '今夜' || text == '今夕' || text == '今晩') {
            components.imply('hour', 22);
            components.assign('meridiem', index_1.Meridiem.PM);
        }
        else if (text.match("今朝")) {
            components.imply('hour', 6);
            components.assign('meridiem', index_1.Meridiem.AM);
        }
        else if (text == '明日') {
            if (date.hour() > 4) {
                date = date.add(1, 'day');
            }
        }
        else if (text == '昨日') {
            date = date.add(-1, 'day');
        }
        components.assign('day', date.date());
        components.assign('month', date.month() + 1);
        components.assign('year', date.year());
        return components;
    };
    return JPCasualDateParser;
}());
exports.default = JPCasualDateParser;
